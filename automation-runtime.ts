interface Rectangle {
    x:      number;
    y:      number;
    width:  number;
    height: number;
}

interface ElementInfo {
    attributes?:   [ name: string, value: string ][];
    boundingBox?:  Rectangle;
    innerHTML?:    string;
    innerText?:    string;
    inputValue?:   string;
    isChecked?:    boolean;
    isConnected?:  boolean;
    isEditable?:   boolean;
    isEnabled?:    boolean;
    isStable?:     boolean;
    isTarget?:     boolean;
    isVisible?:    boolean;
    namespaceURI?: string | null;
    nodeName?:     string;
    textContent?:  string | null;
}

function sleep(timeout: number): Promise<void> {
    return new Promise((resolve) => setTimeout(resolve, timeout));
}

function attributes(el: HTMLElement): ElementInfo['attributes'] {
    if (typeof el.getAttributeNames === 'function') {
        return el.getAttributeNames().map((name) => [name, el.getAttribute(name)!])
    } else {
        const result: ElementInfo['attributes'] = [], attrs = el.attributes;

        for (let i = 0; i < attrs.length; ++i) {
            const attr = attrs.item(i)!;
            result.push([attr.name, attr.value]);
        }

        return result;
    }
}

function boundingBox(el: HTMLElement): Rectangle {
    const bb = el.getBoundingClientRect();

    return { x: bb.left, y: bb.top, width: bb.width, height: bb.height };
}

function isTarget(el: HTMLElement): ElementInfo['isTarget'] {
    const bb = boundingBox(el);

    for (let target = document.elementFromPoint(bb.x + bb.width / 2, bb.y + bb.height / 2); target; target = target.parentElement!) {
        if (el === target) {
            return true;
        }
    }

    return false;
}

function isVisible(el: HTMLElement): ElementInfo['isVisible'] {
    const bb = boundingBox(el);

    if (bb.width !== 0 && bb.height !== 0) {
        return window.getComputedStyle(el).visibility !== 'hidden';
    } else {
        return false;
    }
}

function isConnected(el: HTMLElement): boolean {
    return el.isConnected ?? !(el.ownerDocument.compareDocumentPosition(el) & el.DOCUMENT_POSITION_DISCONNECTED);
}

function escapeRegExp(str: string) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
}

function querySelectorAll(selector: string, root?: Document | HTMLElement): HTMLElement[] {
    return (kagekiri as any).querySelectorAll(selector, root);
}

function textNodes(parent: ParentNode | ParentNode[], result: Node[] = []): Node[] {
    if (Array.isArray(parent)) {
        parent.forEach((p) => textNodes(p, result));
    } else {
        for (let length = parent.childNodes.length, i = 0; i < length; ++i) {
            const child = parent.childNodes[i];

            if (child.nodeType === Node.TEXT_NODE) {
                result.push(child);
            } else if (isElement(child)) {
                textNodes(child, result);
            }
        }

        if (isElement(parent) && parent.shadowRoot) {
            textNodes(parent.shadowRoot, result);
        }
    }

    return result;
}

function isElement(node: Node): node is HTMLElement {
    return node?.nodeType === Node.ELEMENT_NODE;
}

class RuntimeSupport {
    click(x: number, y: number) {
        const el = document.elementFromPoint(x, y)!;

        el.dispatchEvent(new MouseEvent('click', {
            bubbles:    true,
            cancelable: true,
            screenX:    x,
            screenY:    y,
            clientX:    x,
            clientY:    y,
        }));
    }

    async tap(x: number, y: number) {
        const el = document.elementFromPoint(x, y)!;
        const tl = [ new Touch({ identifier: 0, target: el, clientX: x, clientY: y, pageX: x, pageY: y, screenX: x, screenY: y }) ];

        el.dispatchEvent(new TouchEvent('touchstart', {
            bubbles:        true,
            cancelable:     true,
            composed:       true,
            changedTouches: tl,
            targetTouches:  tl,
            touches:        tl,
        }));

        el.dispatchEvent(new TouchEvent('touchend', {
            bubbles:        true,
            cancelable:     true,
            composed:       true,
            changedTouches: tl,
        }));
    }

    fill(selectors: string[], value: string) {
        const [ el ] = this._findElements(selectors) as HTMLInputElement[];

        el.focus();
        el.value = value;
        el.dispatchEvent(new Event('input', {
            bubbles:    true,
            cancelable: false,
            composed:   true,
        }));
    }

    private _findElements(selectors: string[], rslt?: (Document | HTMLElement)[]): HTMLElement[] {
        for (const selector of selectors) {
            let ctxs = rslt, path = '', text: RegExp | null = null;

            if (selector.startsWith('nth=')) {
                ctxs ??= [];
                rslt = [...ctxs].splice(Number(selector.substring(4)), 1);
            } else if (selector.startsWith('has=')) {
                ctxs ??= [];
                rslt = [...ctxs].filter((ctx) => this._findElements(JSON.parse(selector.substring(4)), [ ctx ]).length);
            } else if (selector.startsWith('css=')) {
                ctxs ??= [ document ];
                rslt = [];
                ctxs.forEach((ctx) => querySelectorAll(selector.substring(4), ctx).forEach((el) => rslt!.push(el)));
            } else if (selector.startsWith('xpath=')) {
                ctxs ??= [ document ];
                path = selector.substring(6);
            } else if (selector.startsWith(`text=/`)) {
                ctxs ??= [ document.body ];
                text = RegExp.apply(RegExp, selector.substring(5).match(/\/(.*)\/(.*)/)?.slice(1) as [string, string] ?? [ '.^' ])
            } else if (selector.startsWith(`text="`) || selector.startsWith(`text='`) && selector[5] === selector[selector.length - 1]) {
                ctxs ??= [ document.body ];
                text = RegExp('^' + escapeRegExp(selector.substring(6, selector.length - 1)) + '$');
            } else if (selector.startsWith('text=')) {
                ctxs ??= [ document.body ];
                text = RegExp(escapeRegExp(selector.substring(5)), 'i');
            } else {
                throw new EvalError('Unknown selector: ' + selector);
            }

            if (path) {
                const nodes: Node[] = [];

                for (const ctx of ctxs) {
                    const xpath = path.startsWith('/') && ctx !== document ? `.${path}` : path;

                    for (let result = document.evaluate(xpath, ctx), node = result.iterateNext(); node; node = result.iterateNext()) {
                        nodes.push(node);
                    }
                }

                rslt = nodes.filter(isElement);
            } else if (text) {
                const normalized = (text?: string | null) => text?.replace(/\s+/g, ' ').trim() ?? '';

                rslt = textNodes(ctxs).filter((tn) => text.test(normalized(tn.nodeValue))).map((tn) => tn.parentElement!);
            }
        }

        // Remove dupes
        return rslt?.filter((element, index, array) => array.indexOf(element) === index) as HTMLElement[] ?? [];
    }

    resolveSelectors(selectors: string[], props: (keyof ElementInfo)[]): ElementInfo[] {
        const elements = this._findElements(selectors);

        if (props.indexOf('isStable') >= 0 && props.indexOf('boundingBox') < 0) {
            props.push('boundingBox');
        }

        return elements.map((el: HTMLElement & Partial<HTMLInputElement>) => {
            const info: ElementInfo = {};

            for (const prop of props) {
                switch (prop) {
                    case 'attributes':   info[prop] = attributes(el);       break;
                    case 'boundingBox':  info[prop] = boundingBox(el);      break;
                    case 'innerHTML':    info[prop] = el.innerHTML;         break;
                    case 'innerText':    info[prop] = el.innerText;         break;
                    case 'inputValue':   info[prop] = el.value;             break;
                    case 'isChecked':    info[prop] = el.checked;           break;
                    case 'isConnected':  info[prop] = isConnected(el);      break;
                    case 'isEditable':   info[prop] = el.isContentEditable; break;
                    case 'isEnabled':    info[prop] = el.disabled !== true; break;
                    case 'isStable':     /* Already handled */;             break;
                    case 'isTarget':     info[prop] = isTarget(el);         break;
                    case 'isVisible':    info[prop] = isVisible(el);        break;
                    case 'namespaceURI': info[prop] = el.namespaceURI;      break;
                    case 'nodeName':     info[prop] = el.nodeName;          break;
                    case 'textContent':  info[prop] = el.textContent;       break;
                }
            }

            return info;
        });
    }

    evaluateAll(selectors: string[], func: string, arg: unknown): unknown {
        const elements = this._findElements(selectors);

        return new Function(`return (${func}).apply(null, arguments)`)(elements, arg);
    }

    evaluatePageFunction(expr: string, arg: unknown): unknown {
        const result = eval(expr) as unknown;

        if (typeof result === 'function') {
            return result.call(null, arg);
        } else {
            return result;
        }
    }

    waitForRepaint(): Promise<void> {
        return new Promise((resolve) => {
            window.requestAnimationFrame(() => window.requestAnimationFrame(() => resolve()));
        })
    }
}

// @ts-ignore
// *** kagekiri@1.4.3 ***

// Copyright (c) 2020, Salesforce.com, Inc.
// All rights reserved.

// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
// following conditions are met:

// * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
//   disclaimer.

// * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following
//   disclaimer in the documentation and/or other materials provided with the distribution.

// * Neither the name of Salesforce.com nor the names of its contributors may be used to endorse or promote products
//   derived from this software without specific prior written permission.

// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
// INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
// WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

var kagekiri=function(e){"use strict";var t,r,n;String.prototype.startsWith||(t=function(){try{var e={},t=Object.defineProperty,r=t(e,e,e)&&t}catch(e){}return r}(),r={}.toString,n=function(e){if(null==this)throw TypeError();var t=String(this);if(e&&"[object RegExp]"==r.call(e))throw TypeError();var n=t.length,i=String(e),o=i.length,s=arguments.length>1?arguments[1]:void 0,a=s?Number(s):0;a!=a&&(a=0);var u=Math.min(Math.max(a,0),n);if(o+u>n)return!1;for(var c=-1;++c<o;)if(t.charCodeAt(u+c)!=i.charCodeAt(c))return!1;return!0},t?t(String.prototype,"startsWith",{value:n,configurable:!0,writable:!0}):String.prototype.startsWith=n),String.prototype.endsWith||function(){var e=function(){try{var e={},t=Object.defineProperty,r=t(e,e,e)&&t}catch(e){}return r}(),t={}.toString,r=function(e){if(null==this)throw TypeError();var r=String(this);if(e&&"[object RegExp]"==t.call(e))throw TypeError();var n=r.length,i=String(e),o=i.length,s=n;if(arguments.length>1){var a=arguments[1];void 0!==a&&(s=a?Number(a):0)!=s&&(s=0)}var u=Math.min(Math.max(s,0),n),c=u-o;if(c<0)return!1;for(var f=-1;++f<o;)if(r.charCodeAt(c+f)!=i.charCodeAt(f))return!1;return!0};e?e(String.prototype,"endsWith",{value:r,configurable:!0,writable:!0}):String.prototype.endsWith=r}();var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var u=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,n,u=arguments,c=a(e),f=1;f<arguments.length;f++){for(var l in r=Object(u[f]))o.call(r,l)&&(c[l]=r[l]);if(i){n=i(r);for(var p=0;p<n.length;p++)s.call(r,n[p])&&(c[n[p]]=r[n[p]])}}return c},c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function f(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function l(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var p=l((function(e,t){function r(e){for(var t=e.toLowerCase(),r="",n=!1,i=0;i<6&&void 0!==t[i];i++){var o=t.charCodeAt(i);if(n=32===o,!(o>=97&&o<=102||o>=48&&o<=57))break;r+=t[i]}if(0!==r.length){var s=parseInt(r,16);return s>=55296&&s<=57343||0===s||s>1114111?["�",r.length+(n?1:0)]:[String.fromCodePoint(s),r.length+(n?1:0)]}}t.__esModule=!0,t.default=function(e){if(!n.test(e))return e;for(var t="",i=0;i<e.length;i++)if("\\"!==e[i])t+=e[i];else{var o=r(e.slice(i+1,i+7));if(void 0!==o){t+=o[0],i+=o[1];continue}if("\\"===e[i+1]){t+="\\",i++;continue}e.length===i+1&&(t+=e[i])}return t};var n=/\\/;e.exports=t.default})),h=l((function(e,t){t.__esModule=!0,t.default=function(e){for(var t=arguments,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=t[i];for(;n.length>0;){var o=n.shift();if(!e[o])return;e=e[o]}return e},e.exports=t.default})),d=l((function(e,t){t.__esModule=!0,t.default=function(e){for(var t=arguments,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=t[i];for(;n.length>0;){var o=n.shift();e[o]||(e[o]={}),e=e[o]}},e.exports=t.default})),v=l((function(e,t){t.__esModule=!0,t.default=function(e){var t="",r=e.indexOf("/*"),n=0;for(;r>=0;){t+=e.slice(n,r);var i=e.indexOf("*/",r+2);if(i<0)return t;n=i+2,r=e.indexOf("/*",n)}return t+=e.slice(n)},e.exports=t.default})),b=l((function(e,t){t.__esModule=!0,t.unesc=t.stripComments=t.getProp=t.ensureObject=void 0;var r=s(p);t.unesc=r.default;var n=s(h);t.getProp=n.default;var i=s(d);t.ensureObject=i.default;var o=s(v);function s(e){return e&&e.__esModule?e:{default:e}}t.stripComments=o.default})),y=l((function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.__esModule=!0,t.default=void 0;var n=function e(t,r){if("object"!=typeof t||null===t)return t;var n=new t.constructor;for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];"parent"===i&&"object"===typeof o?r&&(n[i]=r):n[i]=o instanceof Array?o.map((function(t){return e(t,n)})):e(o,n)}return n},i=function(){function e(e){void 0===e&&(e={}),u(this,e),this.spaces=this.spaces||{},this.spaces.before=this.spaces.before||"",this.spaces.after=this.spaces.after||""}var t,i,o,s=e.prototype;return s.remove=function(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this},s.replaceWith=function(){var e=arguments;if(this.parent){for(var t in arguments)this.parent.insertBefore(this,e[t]);this.remove()}return this},s.next=function(){return this.parent.at(this.parent.index(this)+1)},s.prev=function(){return this.parent.at(this.parent.index(this)-1)},s.clone=function(e){void 0===e&&(e={});var t=n(this);for(var r in e)t[r]=e[r];return t},s.appendToPropertyAndEscape=function(e,t,r){this.raws||(this.raws={});var n=this[e],i=this.raws[e];this[e]=n+t,i||r!==t?this.raws[e]=(i||n)+r:delete this.raws[e]},s.setPropertyAndEscape=function(e,t,r){this.raws||(this.raws={}),this[e]=t,this.raws[e]=r},s.setPropertyWithoutEscape=function(e,t){this[e]=t,this.raws&&delete this.raws[e]},s.isAtPosition=function(e,t){if(this.source&&this.source.start&&this.source.end)return!(this.source.start.line>e)&&(!(this.source.end.line<e)&&(!(this.source.start.line===e&&this.source.start.column>t)&&!(this.source.end.line===e&&this.source.end.column<t)))},s.stringifyProperty=function(e){return this.raws&&this.raws[e]||this[e]},s.valueToString=function(){return String(this.stringifyProperty("value"))},s.toString=function(){return[this.rawSpaceBefore,this.valueToString(),this.rawSpaceAfter].join("")},t=e,(i=[{key:"rawSpaceBefore",get:function(){var e=this.raws&&this.raws.spaces&&this.raws.spaces.before;return void 0===e&&(e=this.spaces&&this.spaces.before),e||""},set:function(e){(0,b.ensureObject)(this,"raws","spaces"),this.raws.spaces.before=e}},{key:"rawSpaceAfter",get:function(){var e=this.raws&&this.raws.spaces&&this.raws.spaces.after;return void 0===e&&(e=this.spaces.after),e||""},set:function(e){(0,b.ensureObject)(this,"raws","spaces"),this.raws.spaces.after=e}}])&&r(t.prototype,i),o&&r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=i,e.exports=t.default})),g=l((function(e,t){t.__esModule=!0,t.UNIVERSAL=t.TAG=t.STRING=t.SELECTOR=t.ROOT=t.PSEUDO=t.NESTING=t.ID=t.COMMENT=t.COMBINATOR=t.CLASS=t.ATTRIBUTE=void 0;t.TAG="tag";t.STRING="string";t.SELECTOR="selector";t.ROOT="root";t.PSEUDO="pseudo";t.NESTING="nesting";t.ID="id";t.COMMENT="comment";t.COMBINATOR="combinator";t.CLASS="class";t.ATTRIBUTE="attribute";t.UNIVERSAL="universal"})),S=l((function(e,t){t.__esModule=!0,t.default=void 0;var r,n=(r=y)&&r.__esModule?r:{default:r},i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=i?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(g);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var l=function(e){var t,r;function n(t){var r;return(r=e.call(this,t)||this).nodes||(r.nodes=[]),r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,f(t,r);var o,a,l,p=n.prototype;return p.append=function(e){return e.parent=this,this.nodes.push(e),this},p.prepend=function(e){return e.parent=this,this.nodes.unshift(e),this},p.at=function(e){return this.nodes[e]},p.index=function(e){return"number"==typeof e?e:this.nodes.indexOf(e)},p.removeChild=function(e){var t;for(var r in e=this.index(e),this.at(e).parent=void 0,this.nodes.splice(e,1),this.indexes)(t=this.indexes[r])>=e&&(this.indexes[r]=t-1);return this},p.removeAll=function(){for(var e,t=s(this.nodes);!(e=t()).done;){e.value.parent=void 0}return this.nodes=[],this},p.empty=function(){return this.removeAll()},p.insertAfter=function(e,t){t.parent=this;var r,n=this.index(e);for(var i in this.nodes.splice(n+1,0,t),t.parent=this,this.indexes)n<=(r=this.indexes[i])&&(this.indexes[i]=r+1);return this},p.insertBefore=function(e,t){t.parent=this;var r,n=this.index(e);for(var i in this.nodes.splice(n,0,t),t.parent=this,this.indexes)(r=this.indexes[i])<=n&&(this.indexes[i]=r+1);return this},p._findChildAtPosition=function(e,t){var r=void 0;return this.each((function(n){if(n.atPosition){var i=n.atPosition(e,t);if(i)return r=i,!1}else if(n.isAtPosition(e,t))return r=n,!1})),r},p.atPosition=function(e,t){return this.isAtPosition(e,t)?this._findChildAtPosition(e,t)||this:void 0},p._inferEndPosition=function(){this.last&&this.last.source&&this.last.source.end&&(this.source=this.source||{},this.source.end=this.source.end||{},u(this.source.end,this.last.source.end))},p.each=function(e){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach++;var t=this.lastEach;if(this.indexes[t]=0,this.length){for(var r,n;this.indexes[t]<this.length&&(r=this.indexes[t],!1!==(n=e(this.at(r),r)));)this.indexes[t]+=1;return delete this.indexes[t],!1!==n&&void 0}},p.walk=function(e){return this.each((function(t,r){var n=e(t,r);if(!1!==n&&t.length&&(n=t.walk(e)),!1===n)return!1}))},p.walkAttributes=function(e){var t=this;return this.walk((function(r){if(r.type===i.ATTRIBUTE)return e.call(t,r)}))},p.walkClasses=function(e){var t=this;return this.walk((function(r){if(r.type===i.CLASS)return e.call(t,r)}))},p.walkCombinators=function(e){var t=this;return this.walk((function(r){if(r.type===i.COMBINATOR)return e.call(t,r)}))},p.walkComments=function(e){var t=this;return this.walk((function(r){if(r.type===i.COMMENT)return e.call(t,r)}))},p.walkIds=function(e){var t=this;return this.walk((function(r){if(r.type===i.ID)return e.call(t,r)}))},p.walkNesting=function(e){var t=this;return this.walk((function(r){if(r.type===i.NESTING)return e.call(t,r)}))},p.walkPseudos=function(e){var t=this;return this.walk((function(r){if(r.type===i.PSEUDO)return e.call(t,r)}))},p.walkTags=function(e){var t=this;return this.walk((function(r){if(r.type===i.TAG)return e.call(t,r)}))},p.walkUniversals=function(e){var t=this;return this.walk((function(r){if(r.type===i.UNIVERSAL)return e.call(t,r)}))},p.split=function(e){var t=this,r=[];return this.reduce((function(n,i,o){var s=e.call(t,i);return r.push(i),s?(n.push(r),r=[]):o===t.length-1&&n.push(r),n}),[])},p.map=function(e){return this.nodes.map(e)},p.reduce=function(e,t){return this.nodes.reduce(e,t)},p.every=function(e){return this.nodes.every(e)},p.some=function(e){return this.nodes.some(e)},p.filter=function(e){return this.nodes.filter(e)},p.sort=function(e){return this.nodes.sort(e)},p.toString=function(){return this.map(String).join("")},o=n,(a=[{key:"first",get:function(){return this.at(0)}},{key:"last",get:function(){return this.at(this.length-1)}},{key:"length",get:function(){return this.nodes.length}}])&&c(o.prototype,a),l&&c(o,l),Object.defineProperty(o,"prototype",{writable:!1}),n}(n.default);t.default=l,e.exports=t.default})),_=l((function(e,t){var r;function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}t.__esModule=!0,t.default=void 0;var o=function(e){var t,r;function o(t){var r;return(r=e.call(this,t)||this).type=g.ROOT,r}r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,i(t,r);var s,a,u,c=o.prototype;return c.toString=function(){var e=this.reduce((function(e,t){return e.push(String(t)),e}),[]).join(",");return this.trailingComma?e+",":e},c.error=function(e,t){return this._error?this._error(e,t):new Error(e)},s=o,(a=[{key:"errorGenerator",set:function(e){this._error=e}}])&&n(s.prototype,a),u&&n(s,u),Object.defineProperty(s,"prototype",{writable:!1}),o}(((r=S)&&r.__esModule?r:{default:r}).default);t.default=o,e.exports=t.default})),w=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.SELECTOR,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i}(((r=S)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),T={}.hasOwnProperty,m=/[ -,\.\/:-@\[-\^`\{-~]/,O=/[ -,\.\/:-@\[\]\^`\{-~]/,E=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,k=function e(t,r){"single"!=(r=function(e,t){if(!e)return t;var r={};for(var n in t)r[n]=T.call(e,n)?e[n]:t[n];return r}(r,e.options)).quotes&&"double"!=r.quotes&&(r.quotes="single");for(var n="double"==r.quotes?'"':"'",i=r.isIdentifier,o=t.charAt(0),s="",a=0,u=t.length;a<u;){var c=t.charAt(a++),f=c.charCodeAt(),l=void 0;if(f<32||f>126){if(f>=55296&&f<=56319&&a<u){var p=t.charCodeAt(a++);56320==(64512&p)?f=((1023&f)<<10)+(1023&p)+65536:a--}l="\\"+f.toString(16).toUpperCase()+" "}else l=r.escapeEverything?m.test(c)?"\\"+c:"\\"+f.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(c)?"\\"+f.toString(16).toUpperCase()+" ":"\\"==c||!i&&('"'==c&&n==c||"'"==c&&n==c)||i&&O.test(c)?"\\"+c:c;s+=l}return i&&(/^-[-\d]/.test(s)?s="\\-"+s.slice(1):/\d/.test(o)&&(s="\\3"+o+" "+s.slice(1))),s=s.replace(E,(function(e,t,r){return t&&t.length%2?e:(t||"")+r})),!i&&r.wrap?n+s+n:s};k.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},k.version="3.0.0";var P=k,I=l((function(e,t){t.__esModule=!0,t.default=void 0;var r=n(P);function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}var s=function(e){var t,n,s,a,u;function c(t){var r;return(r=e.call(this,t)||this).type=g.CLASS,r._constructed=!0,r}return n=e,(t=c).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n),c.prototype.valueToString=function(){return"."+e.prototype.valueToString.call(this)},s=c,(a=[{key:"value",get:function(){return this._value},set:function(e){if(this._constructed){var t=(0,r.default)(e,{isIdentifier:!0});t!==e?((0,b.ensureObject)(this,"raws"),this.raws.value=t):this.raws&&delete this.raws.value}this._value=e}}])&&i(s.prototype,a),u&&i(s,u),Object.defineProperty(s,"prototype",{writable:!1}),c}(n(y).default);t.default=s,e.exports=t.default})),L=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.COMMENT,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i}(((r=y)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),x=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.ID,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i.prototype.valueToString=function(){return"#"+e.prototype.valueToString.call(this)},i}(((r=y)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),j=l((function(e,t){t.__esModule=!0,t.default=void 0;var r=n(P);function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}var s=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var a,u,c,f=s.prototype;return f.qualifiedName=function(e){return this.namespace?this.namespaceString+"|"+e:e},f.valueToString=function(){return this.qualifiedName(e.prototype.valueToString.call(this))},a=s,u=[{key:"namespace",get:function(){return this._namespace},set:function(e){if(!0===e||"*"===e||"&"===e)return this._namespace=e,void(this.raws&&delete this.raws.namespace);var t=(0,r.default)(e,{isIdentifier:!0});this._namespace=e,t!==e?((0,b.ensureObject)(this,"raws"),this.raws.namespace=t):this.raws&&delete this.raws.namespace}},{key:"ns",get:function(){return this._namespace},set:function(e){this.namespace=e}},{key:"namespaceString",get:function(){if(this.namespace){var e=this.stringifyProperty("namespace");return!0===e?"":e}return""}}],u&&i(a.prototype,u),c&&i(a,c),Object.defineProperty(a,"prototype",{writable:!1}),s}(n(y).default);t.default=s,e.exports=t.default})),D=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.TAG,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i}(((r=j)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),M=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.STRING,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i}(((r=y)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),A=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.PSEUDO,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i.prototype.toString=function(){var e=this.length?"("+this.map(String).join(",")+")":"";return[this.rawSpaceBefore,this.stringifyProperty("value"),e,this.rawSpaceAfter].join("")},i}(((r=S)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),N=function(e,t){if(F("noDeprecation"))return e;var r=!1;return function(){if(!r){if(F("throwDeprecation"))throw new Error(t);F("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}};function F(e){try{if(!c.localStorage)return!1}catch(e){return!1}var t=c.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}var C=l((function(e,t){t.__esModule=!0,t.default=void 0,t.unescapeValue=v;var r,n=s(P),i=s(p),o=s(j);function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}var f=/^('|")([^]*)\1$/,l=N((function(){}),"Assigning an attribute a value containing characters that might need to be escaped is deprecated. Call attribute.setValue() instead."),h=N((function(){}),"Assigning attr.quoted is deprecated and has no effect. Assign to attr.quoteMark instead."),d=N((function(){}),"Constructing an Attribute selector with a value without specifying quoteMark is deprecated. Note: The value should be unescaped now.");function v(e){var t=!1,r=null,n=e,o=n.match(f);return o&&(r=o[1],n=o[2]),(n=(0,i.default)(n))!==e&&(t=!0),{deprecatedUsage:t,unescaped:n,quoteMark:r}}var b=function(e){var t,r;function i(t){var r;return void 0===t&&(t={}),r=e.call(this,function(e){if(void 0!==e.quoteMark)return e;if(void 0===e.value)return e;d();var t=v(e.value),r=t.quoteMark,n=t.unescaped;return e.raws||(e.raws={}),void 0===e.raws.value&&(e.raws.value=e.value),e.value=n,e.quoteMark=r,e}(t))||this,r.type=g.ATTRIBUTE,r.raws=r.raws||{},Object.defineProperty(r.raws,"unquoted",{get:N((function(){return r.value}),"attr.raws.unquoted is deprecated. Call attr.value instead."),set:N((function(){return r.value}),"Setting attr.raws.unquoted is deprecated and has no effect. attr.value is unescaped by default now.")}),r._constructed=!0,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,c(t,r);var o,s,f,p=i.prototype;return p.getQuotedValue=function(e){void 0===e&&(e={});var t=this._determineQuoteMark(e),r=y[t];return(0,n.default)(this._value,r)},p._determineQuoteMark=function(e){return e.smart?this.smartQuoteMark(e):this.preferredQuoteMark(e)},p.setValue=function(e,t){void 0===t&&(t={}),this._value=e,this._quoteMark=this._determineQuoteMark(t),this._syncRawValue()},p.smartQuoteMark=function(e){var t=this.value,r=t.replace(/[^']/g,"").length,o=t.replace(/[^"]/g,"").length;if(r+o===0){var s=(0,n.default)(t,{isIdentifier:!0});if(s===t)return i.NO_QUOTE;var a=this.preferredQuoteMark(e);if(a===i.NO_QUOTE){var u=this.quoteMark||e.quoteMark||i.DOUBLE_QUOTE,c=y[u];if((0,n.default)(t,c).length<s.length)return u}return a}return o===r?this.preferredQuoteMark(e):o<r?i.DOUBLE_QUOTE:i.SINGLE_QUOTE},p.preferredQuoteMark=function(e){var t=e.preferCurrentQuoteMark?this.quoteMark:e.quoteMark;return void 0===t&&(t=e.preferCurrentQuoteMark?e.quoteMark:this.quoteMark),void 0===t&&(t=i.DOUBLE_QUOTE),t},p._syncRawValue=function(){var e=(0,n.default)(this._value,y[this.quoteMark]);e===this._value?this.raws&&delete this.raws.value:this.raws.value=e},p._handleEscapes=function(e,t){if(this._constructed){var r=(0,n.default)(t,{isIdentifier:!0});r!==t?this.raws[e]=r:delete this.raws[e]}},p._spacesFor=function(e){var t=this.spaces[e]||{},r=this.raws.spaces&&this.raws.spaces[e]||{};return u({before:"",after:""},t,r)},p._stringFor=function(e,t,r){void 0===t&&(t=e),void 0===r&&(r=S);var n=this._spacesFor(t);return r(this.stringifyProperty(e),n)},p.offsetOf=function(e){var t=1,r=this._spacesFor("attribute");if(t+=r.before.length,"namespace"===e||"ns"===e)return this.namespace?t:-1;if("attributeNS"===e)return t;if(t+=this.namespaceString.length,this.namespace&&(t+=1),"attribute"===e)return t;t+=this.stringifyProperty("attribute").length,t+=r.after.length;var n=this._spacesFor("operator");t+=n.before.length;var i=this.stringifyProperty("operator");if("operator"===e)return i?t:-1;t+=i.length,t+=n.after.length;var o=this._spacesFor("value");t+=o.before.length;var s=this.stringifyProperty("value");return"value"===e?s?t:-1:(t+=s.length,t+=o.after.length,t+=this._spacesFor("insensitive").before.length,"insensitive"===e&&this.insensitive?t:-1)},p.toString=function(){var e=this,t=[this.rawSpaceBefore,"["];return t.push(this._stringFor("qualifiedAttribute","attribute")),this.operator&&(this.value||""===this.value)&&(t.push(this._stringFor("operator")),t.push(this._stringFor("value")),t.push(this._stringFor("insensitiveFlag","insensitive",(function(t,r){return!(t.length>0)||e.quoted||0!==r.before.length||e.spaces.value&&e.spaces.value.after||(r.before=" "),S(t,r)})))),t.push("]"),t.push(this.rawSpaceAfter),t.join("")},o=i,(s=[{key:"quoted",get:function(){var e=this.quoteMark;return"'"===e||'"'===e},set:function(e){h()}},{key:"quoteMark",get:function(){return this._quoteMark},set:function(e){this._constructed?this._quoteMark!==e&&(this._quoteMark=e,this._syncRawValue()):this._quoteMark=e}},{key:"qualifiedAttribute",get:function(){return this.qualifiedName(this.raws.attribute||this.attribute)}},{key:"insensitiveFlag",get:function(){return this.insensitive?"i":""}},{key:"value",get:function(){return this._value},set:function(e){if(this._constructed){var t=v(e),r=t.deprecatedUsage,n=t.unescaped,i=t.quoteMark;if(r&&l(),n===this._value&&i===this._quoteMark)return;this._value=n,this._quoteMark=i,this._syncRawValue()}else this._value=e}},{key:"insensitive",get:function(){return this._insensitive},set:function(e){e||(this._insensitive=!1,!this.raws||"I"!==this.raws.insensitiveFlag&&"i"!==this.raws.insensitiveFlag||(this.raws.insensitiveFlag=void 0)),this._insensitive=e}},{key:"attribute",get:function(){return this._attribute},set:function(e){this._handleEscapes("attribute",e),this._attribute=e}}])&&a(o.prototype,s),f&&a(o,f),Object.defineProperty(o,"prototype",{writable:!1}),i}(o.default);t.default=b,b.NO_QUOTE=null,b.SINGLE_QUOTE="'",b.DOUBLE_QUOTE='"';var y=((r={"'":{quotes:"single",wrap:!0},'"':{quotes:"double",wrap:!0}}).null={isIdentifier:!0},r);function S(e,t){return""+t.before+e+t.after}})),q=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.UNIVERSAL,r.value="*",r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i}(((r=j)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),R=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.COMBINATOR,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i}(((r=y)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),U=l((function(e,t){var r;function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}t.__esModule=!0,t.default=void 0;var i=function(e){var t,r;function i(t){var r;return(r=e.call(this,t)||this).type=g.NESTING,r.value="&",r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,n(t,r),i}(((r=y)&&r.__esModule?r:{default:r}).default);t.default=i,e.exports=t.default})),Y=l((function(e,t){t.__esModule=!0,t.default=function(e){return e.sort((function(e,t){return e-t}))},e.exports=t.default})),B=l((function(e,t){t.__esModule=!0,t.word=t.tilde=t.tab=t.str=t.space=t.slash=t.singleQuote=t.semicolon=t.plus=t.pipe=t.openSquare=t.openParenthesis=t.newline=t.greaterThan=t.feed=t.equals=t.doubleQuote=t.dollar=t.cr=t.comment=t.comma=t.combinator=t.colon=t.closeSquare=t.closeParenthesis=t.caret=t.bang=t.backslash=t.at=t.asterisk=t.ampersand=void 0;t.ampersand=38;t.asterisk=42;t.at=64;t.comma=44;t.colon=58;t.semicolon=59;t.openParenthesis=40;t.closeParenthesis=41;t.openSquare=91;t.closeSquare=93;t.dollar=36;t.tilde=126;t.caret=94;t.plus=43;t.equals=61;t.pipe=124;t.greaterThan=62;t.space=32;t.singleQuote=39;t.doubleQuote=34;t.slash=47;t.bang=33;t.backslash=92;t.cr=13;t.feed=12;t.newline=10;t.tab=9;t.str=39;t.comment=-1;t.word=-2;t.combinator=-3})),W=l((function(e,t){t.__esModule=!0,t.FIELDS=void 0,t.default=function(e){var t,r,n,o,s,a,u,c,f,p,h,d,v,b=[],y=e.css.valueOf(),g=y.length,S=-1,_=1,w=0,T=0;function m(t,r){if(!e.safe)throw e.error("Unclosed "+t,_,w-S,w);f=(y+=r).length-1}for(;w<g;){switch((t=y.charCodeAt(w))===i.newline&&(S=w,_+=1),t){case i.space:case i.tab:case i.newline:case i.cr:case i.feed:f=w;do{f+=1,(t=y.charCodeAt(f))===i.newline&&(S=f,_+=1)}while(t===i.space||t===i.newline||t===i.tab||t===i.cr||t===i.feed);v=i.space,o=_,n=f-S-1,T=f;break;case i.plus:case i.greaterThan:case i.tilde:case i.pipe:f=w;do{f+=1,t=y.charCodeAt(f)}while(t===i.plus||t===i.greaterThan||t===i.tilde||t===i.pipe);v=i.combinator,o=_,n=w-S,T=f;break;case i.asterisk:case i.ampersand:case i.bang:case i.comma:case i.equals:case i.dollar:case i.caret:case i.openSquare:case i.closeSquare:case i.colon:case i.semicolon:case i.openParenthesis:case i.closeParenthesis:v=t,o=_,n=w-S,T=(f=w)+1;break;case i.singleQuote:case i.doubleQuote:d=t===i.singleQuote?"'":'"',f=w;do{for(s=!1,-1===(f=y.indexOf(d,f+1))&&m("quote",d),a=f;y.charCodeAt(a-1)===i.backslash;)a-=1,s=!s}while(s);v=i.str,o=_,n=w-S,T=f+1;break;default:t===i.slash&&y.charCodeAt(w+1)===i.asterisk?(0===(f=y.indexOf("*/",w+2)+1)&&m("comment","*/"),r=y.slice(w,f+1),c=r.split("\n"),(u=c.length-1)>0?(p=_+u,h=f-c[u].length):(p=_,h=S),v=i.comment,_=p,o=p,n=f-h):t===i.slash?(v=t,o=_,n=w-S,T=(f=w)+1):(f=l(y,w),v=i.word,o=_,n=f-S),T=f+1}b.push([v,_,w-S,o,n,w,T]),h&&(S=h,h=null),w=T}return b};var r,n,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=i?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(B);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}for(var s=((r={})[i.tab]=!0,r[i.newline]=!0,r[i.cr]=!0,r[i.feed]=!0,r),a=((n={})[i.space]=!0,n[i.tab]=!0,n[i.newline]=!0,n[i.cr]=!0,n[i.feed]=!0,n[i.ampersand]=!0,n[i.asterisk]=!0,n[i.bang]=!0,n[i.comma]=!0,n[i.colon]=!0,n[i.semicolon]=!0,n[i.openParenthesis]=!0,n[i.closeParenthesis]=!0,n[i.openSquare]=!0,n[i.closeSquare]=!0,n[i.singleQuote]=!0,n[i.doubleQuote]=!0,n[i.plus]=!0,n[i.pipe]=!0,n[i.tilde]=!0,n[i.greaterThan]=!0,n[i.equals]=!0,n[i.dollar]=!0,n[i.caret]=!0,n[i.slash]=!0,n),u={},c="0123456789abcdefABCDEF",f=0;f<c.length;f++)u[c.charCodeAt(f)]=!0;function l(e,t){var r,n=t;do{if(r=e.charCodeAt(n),a[r])return n-1;r===i.backslash?n=p(e,n)+1:n++}while(n<e.length);return n-1}function p(e,t){var r=t,n=e.charCodeAt(r+1);if(s[n]);else if(u[n]){var o=0;do{r++,o++,n=e.charCodeAt(r+1)}while(u[n]&&o<6);o<6&&n===i.space&&r++}else r++;return r}t.FIELDS={TYPE:0,START_LINE:1,START_COL:2,END_LINE:3,END_COL:4,START_POS:5,END_POS:6}})),Q=l((function(e,t){t.__esModule=!0,t.default=void 0;var r,n,i=P(_),o=P(w),s=P(I),a=P(L),c=P(x),f=P(D),l=P(M),p=P(A),h=k(C),d=P(q),v=P(R),y=P(U),S=P(Y),T=k(W),m=k(B),O=k(g);function E(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(E=function(e){return e?r:t})(e)}function k(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=E(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function P(e){return e&&e.__esModule?e:{default:e}}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var N=((r={})[m.space]=!0,r[m.cr]=!0,r[m.feed]=!0,r[m.newline]=!0,r[m.tab]=!0,r),F=u({},N,((n={})[m.comment]=!0,n));function Q(e){return{line:e[T.FIELDS.START_LINE],column:e[T.FIELDS.START_COL]}}function G(e){return{line:e[T.FIELDS.END_LINE],column:e[T.FIELDS.END_COL]}}function V(e,t,r,n){return{start:{line:e,column:t},end:{line:r,column:n}}}function $(e){return V(e[T.FIELDS.START_LINE],e[T.FIELDS.START_COL],e[T.FIELDS.END_LINE],e[T.FIELDS.END_COL])}function H(e,t){if(e)return V(e[T.FIELDS.START_LINE],e[T.FIELDS.START_COL],t[T.FIELDS.END_LINE],t[T.FIELDS.END_COL])}function z(e,t){var r=e[t];if("string"==typeof r)return-1!==r.indexOf("\\")&&((0,b.ensureObject)(e,"raws"),e[t]=(0,b.unesc)(r),void 0===e.raws[t]&&(e.raws[t]=r)),e}function J(e,t){for(var r=-1,n=[];-1!==(r=e.indexOf(t,r+1));)n.push(r);return n}var K=function(){function e(e,t){void 0===t&&(t={}),this.rule=e,this.options=u({lossy:!1,safe:!1},t),this.position=0,this.css="string"==typeof this.rule?this.rule:this.rule.selector,this.tokens=(0,T.default)({css:this.css,error:this._errorGenerator(),safe:this.options.safe});var r=H(this.tokens[0],this.tokens[this.tokens.length-1]);this.root=new i.default({source:r}),this.root.errorGenerator=this._errorGenerator();var n=new o.default({source:{start:{line:1,column:1}}});this.root.append(n),this.current=n,this.loop()}var t,r,n,g=e.prototype;return g._errorGenerator=function(){var e=this;return function(t,r){return"string"==typeof e.rule?new Error(t):e.rule.error(t,r)}},g.attribute=function(){var e=[],t=this.currToken;for(this.position++;this.position<this.tokens.length&&this.currToken[T.FIELDS.TYPE]!==m.closeSquare;)e.push(this.currToken),this.position++;if(this.currToken[T.FIELDS.TYPE]!==m.closeSquare)return this.expected("closing square bracket",this.currToken[T.FIELDS.START_POS]);var r=e.length,n={source:V(t[1],t[2],this.currToken[3],this.currToken[4]),sourceIndex:t[T.FIELDS.START_POS]};if(1===r&&!~[m.word].indexOf(e[0][T.FIELDS.TYPE]))return this.expected("attribute",e[0][T.FIELDS.START_POS]);for(var i=0,o="",s="",a=null,u=!1;i<r;){var c=e[i],f=this.content(c),l=e[i+1];switch(c[T.FIELDS.TYPE]){case m.space:if(u=!0,this.options.lossy)break;if(a){(0,b.ensureObject)(n,"spaces",a);var p=n.spaces[a].after||"";n.spaces[a].after=p+f;var d=(0,b.getProp)(n,"raws","spaces",a,"after")||null;d&&(n.raws.spaces[a].after=d+f)}else o+=f,s+=f;break;case m.asterisk:if(l[T.FIELDS.TYPE]===m.equals)n.operator=f,a="operator";else if((!n.namespace||"namespace"===a&&!u)&&l){o&&((0,b.ensureObject)(n,"spaces","attribute"),n.spaces.attribute.before=o,o=""),s&&((0,b.ensureObject)(n,"raws","spaces","attribute"),n.raws.spaces.attribute.before=o,s=""),n.namespace=(n.namespace||"")+f,((0,b.getProp)(n,"raws","namespace")||null)&&(n.raws.namespace+=f),a="namespace"}u=!1;break;case m.dollar:if("value"===a){var v=(0,b.getProp)(n,"raws","value");n.value+="$",v&&(n.raws.value=v+"$");break}case m.caret:l[T.FIELDS.TYPE]===m.equals&&(n.operator=f,a="operator"),u=!1;break;case m.combinator:if("~"===f&&l[T.FIELDS.TYPE]===m.equals&&(n.operator=f,a="operator"),"|"!==f){u=!1;break}l[T.FIELDS.TYPE]===m.equals?(n.operator=f,a="operator"):n.namespace||n.attribute||(n.namespace=!0),u=!1;break;case m.word:if(l&&"|"===this.content(l)&&e[i+2]&&e[i+2][T.FIELDS.TYPE]!==m.equals&&!n.operator&&!n.namespace)n.namespace=f,a="namespace";else if(!n.attribute||"attribute"===a&&!u){o&&((0,b.ensureObject)(n,"spaces","attribute"),n.spaces.attribute.before=o,o=""),s&&((0,b.ensureObject)(n,"raws","spaces","attribute"),n.raws.spaces.attribute.before=s,s=""),n.attribute=(n.attribute||"")+f,((0,b.getProp)(n,"raws","attribute")||null)&&(n.raws.attribute+=f),a="attribute"}else if(!n.value&&""!==n.value||"value"===a&&!u&&!n.quoteMark){var y=(0,b.unesc)(f),g=(0,b.getProp)(n,"raws","value")||"",S=n.value||"";n.value=S+y,n.quoteMark=null,(y!==f||g)&&((0,b.ensureObject)(n,"raws"),n.raws.value=(g||S)+f),a="value"}else{var _="i"===f||"I"===f;!n.value&&""!==n.value||!n.quoteMark&&!u?(n.value||""===n.value)&&(a="value",n.value+=f,n.raws.value&&(n.raws.value+=f)):(n.insensitive=_,_&&"I"!==f||((0,b.ensureObject)(n,"raws"),n.raws.insensitiveFlag=f),a="insensitive",o&&((0,b.ensureObject)(n,"spaces","insensitive"),n.spaces.insensitive.before=o,o=""),s&&((0,b.ensureObject)(n,"raws","spaces","insensitive"),n.raws.spaces.insensitive.before=s,s=""))}u=!1;break;case m.str:if(!n.attribute||!n.operator)return this.error("Expected an attribute followed by an operator preceding the string.",{index:c[T.FIELDS.START_POS]});var w=(0,h.unescapeValue)(f),O=w.unescaped,E=w.quoteMark;n.value=O,n.quoteMark=E,a="value",(0,b.ensureObject)(n,"raws"),n.raws.value=f,u=!1;break;case m.equals:if(!n.attribute)return this.expected("attribute",c[T.FIELDS.START_POS],f);if(n.value)return this.error('Unexpected "=" found; an operator was already defined.',{index:c[T.FIELDS.START_POS]});n.operator=n.operator?n.operator+f:f,a="operator",u=!1;break;case m.comment:if(a)if(u||l&&l[T.FIELDS.TYPE]===m.space||"insensitive"===a){var k=(0,b.getProp)(n,"spaces",a,"after")||"",P=(0,b.getProp)(n,"raws","spaces",a,"after")||k;(0,b.ensureObject)(n,"raws","spaces",a),n.raws.spaces[a].after=P+f}else{var I=n[a]||"",L=(0,b.getProp)(n,"raws",a)||I;(0,b.ensureObject)(n,"raws"),n.raws[a]=L+f}else s+=f;break;default:return this.error('Unexpected "'+f+'" found.',{index:c[T.FIELDS.START_POS]})}i++}z(n,"attribute"),z(n,"namespace"),this.newNode(new h.default(n)),this.position++},g.parseWhitespaceEquivalentTokens=function(e){e<0&&(e=this.tokens.length);var t=this.position,r=[],n="",i=void 0;do{if(N[this.currToken[T.FIELDS.TYPE]])this.options.lossy||(n+=this.content());else if(this.currToken[T.FIELDS.TYPE]===m.comment){var o={};n&&(o.before=n,n=""),i=new a.default({value:this.content(),source:$(this.currToken),sourceIndex:this.currToken[T.FIELDS.START_POS],spaces:o}),r.push(i)}}while(++this.position<e);if(n)if(i)i.spaces.after=n;else if(!this.options.lossy){var s=this.tokens[t],u=this.tokens[this.position-1];r.push(new l.default({value:"",source:V(s[T.FIELDS.START_LINE],s[T.FIELDS.START_COL],u[T.FIELDS.END_LINE],u[T.FIELDS.END_COL]),sourceIndex:s[T.FIELDS.START_POS],spaces:{before:n,after:""}}))}return r},g.convertWhitespaceNodesToSpace=function(e,t){var r=this;void 0===t&&(t=!1);var n="",i="";return e.forEach((function(e){var o=r.lossySpace(e.spaces.before,t),s=r.lossySpace(e.rawSpaceBefore,t);n+=o+r.lossySpace(e.spaces.after,t&&0===o.length),i+=o+e.value+r.lossySpace(e.rawSpaceAfter,t&&0===s.length)})),i===n&&(i=void 0),{space:n,rawSpace:i}},g.isNamedCombinator=function(e){return void 0===e&&(e=this.position),this.tokens[e+0]&&this.tokens[e+0][T.FIELDS.TYPE]===m.slash&&this.tokens[e+1]&&this.tokens[e+1][T.FIELDS.TYPE]===m.word&&this.tokens[e+2]&&this.tokens[e+2][T.FIELDS.TYPE]===m.slash},g.namedCombinator=function(){if(this.isNamedCombinator()){var e=this.content(this.tokens[this.position+1]),t=(0,b.unesc)(e).toLowerCase(),r={};t!==e&&(r.value="/"+e+"/");var n=new v.default({value:"/"+t+"/",source:V(this.currToken[T.FIELDS.START_LINE],this.currToken[T.FIELDS.START_COL],this.tokens[this.position+2][T.FIELDS.END_LINE],this.tokens[this.position+2][T.FIELDS.END_COL]),sourceIndex:this.currToken[T.FIELDS.START_POS],raws:r});return this.position=this.position+3,n}this.unexpected()},g.combinator=function(){var e=this;if("|"===this.content())return this.namespace();var t=this.locateNextMeaningfulToken(this.position);if(!(t<0||this.tokens[t][T.FIELDS.TYPE]===m.comma)){var r,n=this.currToken,i=void 0;if(t>this.position&&(i=this.parseWhitespaceEquivalentTokens(t)),this.isNamedCombinator()?r=this.namedCombinator():this.currToken[T.FIELDS.TYPE]===m.combinator?(r=new v.default({value:this.content(),source:$(this.currToken),sourceIndex:this.currToken[T.FIELDS.START_POS]}),this.position++):N[this.currToken[T.FIELDS.TYPE]]||i||this.unexpected(),r){if(i){var o=this.convertWhitespaceNodesToSpace(i),s=o.space,a=o.rawSpace;r.spaces.before=s,r.rawSpaceBefore=a}}else{var u=this.convertWhitespaceNodesToSpace(i,!0),c=u.space,f=u.rawSpace;f||(f=c);var l={},p={spaces:{}};c.endsWith(" ")&&f.endsWith(" ")?(l.before=c.slice(0,c.length-1),p.spaces.before=f.slice(0,f.length-1)):c.startsWith(" ")&&f.startsWith(" ")?(l.after=c.slice(1),p.spaces.after=f.slice(1)):p.value=f,r=new v.default({value:" ",source:H(n,this.tokens[this.position-1]),sourceIndex:n[T.FIELDS.START_POS],spaces:l,raws:p})}return this.currToken&&this.currToken[T.FIELDS.TYPE]===m.space&&(r.spaces.after=this.optionalSpace(this.content()),this.position++),this.newNode(r)}var h=this.parseWhitespaceEquivalentTokens(t);if(h.length>0){var d=this.current.last;if(d){var b=this.convertWhitespaceNodesToSpace(h),y=b.space,g=b.rawSpace;void 0!==g&&(d.rawSpaceAfter+=g),d.spaces.after+=y}else h.forEach((function(t){return e.newNode(t)}))}},g.comma=function(){if(this.position===this.tokens.length-1)return this.root.trailingComma=!0,void this.position++;this.current._inferEndPosition();var e=new o.default({source:{start:Q(this.tokens[this.position+1])}});this.current.parent.append(e),this.current=e,this.position++},g.comment=function(){var e=this.currToken;this.newNode(new a.default({value:this.content(),source:$(e),sourceIndex:e[T.FIELDS.START_POS]})),this.position++},g.error=function(e,t){throw this.root.error(e,t)},g.missingBackslash=function(){return this.error("Expected a backslash preceding the semicolon.",{index:this.currToken[T.FIELDS.START_POS]})},g.missingParenthesis=function(){return this.expected("opening parenthesis",this.currToken[T.FIELDS.START_POS])},g.missingSquareBracket=function(){return this.expected("opening square bracket",this.currToken[T.FIELDS.START_POS])},g.unexpected=function(){return this.error("Unexpected '"+this.content()+"'. Escaping special characters with \\ may help.",this.currToken[T.FIELDS.START_POS])},g.unexpectedPipe=function(){return this.error("Unexpected '|'.",this.currToken[T.FIELDS.START_POS])},g.namespace=function(){var e=this.prevToken&&this.content(this.prevToken)||!0;return this.nextToken[T.FIELDS.TYPE]===m.word?(this.position++,this.word(e)):this.nextToken[T.FIELDS.TYPE]===m.asterisk?(this.position++,this.universal(e)):void this.unexpectedPipe()},g.nesting=function(){if(this.nextToken&&"|"===this.content(this.nextToken))return void this.position++;var e=this.currToken;this.newNode(new y.default({value:this.content(),source:$(e),sourceIndex:e[T.FIELDS.START_POS]})),this.position++},g.parentheses=function(){var e=this.current.last,t=1;if(this.position++,e&&e.type===O.PSEUDO){var r=new o.default({source:{start:Q(this.tokens[this.position-1])}}),n=this.current;for(e.append(r),this.current=r;this.position<this.tokens.length&&t;)this.currToken[T.FIELDS.TYPE]===m.openParenthesis&&t++,this.currToken[T.FIELDS.TYPE]===m.closeParenthesis&&t--,t?this.parse():(this.current.source.end=G(this.currToken),this.current.parent.source.end=G(this.currToken),this.position++);this.current=n}else{for(var i,s=this.currToken,a="(";this.position<this.tokens.length&&t;)this.currToken[T.FIELDS.TYPE]===m.openParenthesis&&t++,this.currToken[T.FIELDS.TYPE]===m.closeParenthesis&&t--,i=this.currToken,a+=this.parseParenthesisToken(this.currToken),this.position++;e?e.appendToPropertyAndEscape("value",a,a):this.newNode(new l.default({value:a,source:V(s[T.FIELDS.START_LINE],s[T.FIELDS.START_COL],i[T.FIELDS.END_LINE],i[T.FIELDS.END_COL]),sourceIndex:s[T.FIELDS.START_POS]}))}if(t)return this.expected("closing parenthesis",this.currToken[T.FIELDS.START_POS])},g.pseudo=function(){for(var e=this,t="",r=this.currToken;this.currToken&&this.currToken[T.FIELDS.TYPE]===m.colon;)t+=this.content(),this.position++;return this.currToken?this.currToken[T.FIELDS.TYPE]!==m.word?this.expected(["pseudo-class","pseudo-element"],this.currToken[T.FIELDS.START_POS]):void this.splitWord(!1,(function(n,i){t+=n,e.newNode(new p.default({value:t,source:H(r,e.currToken),sourceIndex:r[T.FIELDS.START_POS]})),i>1&&e.nextToken&&e.nextToken[T.FIELDS.TYPE]===m.openParenthesis&&e.error("Misplaced parenthesis.",{index:e.nextToken[T.FIELDS.START_POS]})})):this.expected(["pseudo-class","pseudo-element"],this.position-1)},g.space=function(){var e=this.content();0===this.position||this.prevToken[T.FIELDS.TYPE]===m.comma||this.prevToken[T.FIELDS.TYPE]===m.openParenthesis||this.current.nodes.every((function(e){return"comment"===e.type}))?(this.spaces=this.optionalSpace(e),this.position++):this.position===this.tokens.length-1||this.nextToken[T.FIELDS.TYPE]===m.comma||this.nextToken[T.FIELDS.TYPE]===m.closeParenthesis?(this.current.last.spaces.after=this.optionalSpace(e),this.position++):this.combinator()},g.string=function(){var e=this.currToken;this.newNode(new l.default({value:this.content(),source:$(e),sourceIndex:e[T.FIELDS.START_POS]})),this.position++},g.universal=function(e){var t=this.nextToken;if(t&&"|"===this.content(t))return this.position++,this.namespace();var r=this.currToken;this.newNode(new d.default({value:this.content(),source:$(r),sourceIndex:r[T.FIELDS.START_POS]}),e),this.position++},g.splitWord=function(e,t){for(var r=this,n=this.nextToken,i=this.content();n&&~[m.dollar,m.caret,m.equals,m.word].indexOf(n[T.FIELDS.TYPE]);){this.position++;var o=this.content();if(i+=o,o.lastIndexOf("\\")===o.length-1){var a=this.nextToken;a&&a[T.FIELDS.TYPE]===m.space&&(i+=this.requiredSpace(this.content(a)),this.position++)}n=this.nextToken}var u=J(i,".").filter((function(e){var t="\\"===i[e-1],r=/^\d+\.\d+%$/.test(i);return!t&&!r})),l=J(i,"#").filter((function(e){return"\\"!==i[e-1]})),p=J(i,"#{");p.length&&(l=l.filter((function(e){return!~p.indexOf(e)})));var h=(0,S.default)(function(){var e=Array.prototype.concat.apply([],arguments);return e.filter((function(t,r){return r===e.indexOf(t)}))}([0].concat(u,l)));h.forEach((function(n,o){var a,p=h[o+1]||i.length,d=i.slice(n,p);if(0===o&&t)return t.call(r,d,h.length);var v=r.currToken,b=v[T.FIELDS.START_POS]+h[o],y=V(v[1],v[2]+n,v[3],v[2]+(p-1));if(~u.indexOf(n)){var g={value:d.slice(1),source:y,sourceIndex:b};a=new s.default(z(g,"value"))}else if(~l.indexOf(n)){var S={value:d.slice(1),source:y,sourceIndex:b};a=new c.default(z(S,"value"))}else{var _={value:d,source:y,sourceIndex:b};z(_,"value"),a=new f.default(_)}r.newNode(a,e),e=null})),this.position++},g.word=function(e){var t=this.nextToken;return t&&"|"===this.content(t)?(this.position++,this.namespace()):this.splitWord(e)},g.loop=function(){for(;this.position<this.tokens.length;)this.parse(!0);return this.current._inferEndPosition(),this.root},g.parse=function(e){switch(this.currToken[T.FIELDS.TYPE]){case m.space:this.space();break;case m.comment:this.comment();break;case m.openParenthesis:this.parentheses();break;case m.closeParenthesis:e&&this.missingParenthesis();break;case m.openSquare:this.attribute();break;case m.dollar:case m.caret:case m.equals:case m.word:this.word();break;case m.colon:this.pseudo();break;case m.comma:this.comma();break;case m.asterisk:this.universal();break;case m.ampersand:this.nesting();break;case m.slash:case m.combinator:this.combinator();break;case m.str:this.string();break;case m.closeSquare:this.missingSquareBracket();case m.semicolon:this.missingBackslash();default:this.unexpected()}},g.expected=function(e,t,r){if(Array.isArray(e)){var n=e.pop();e=e.join(", ")+" or "+n}var i=/^[aeiou]/.test(e[0])?"an":"a";return r?this.error("Expected "+i+" "+e+', found "'+r+'" instead.',{index:t}):this.error("Expected "+i+" "+e+".",{index:t})},g.requiredSpace=function(e){return this.options.lossy?" ":e},g.optionalSpace=function(e){return this.options.lossy?"":e},g.lossySpace=function(e,t){return this.options.lossy?t?" ":"":e},g.parseParenthesisToken=function(e){var t=this.content(e);return e[T.FIELDS.TYPE]===m.space?this.requiredSpace(t):t},g.newNode=function(e,t){return t&&(/^ +$/.test(t)&&(this.options.lossy||(this.spaces=(this.spaces||"")+t),t=!0),e.namespace=t,z(e,"namespace")),this.spaces&&(e.spaces.before=this.spaces,this.spaces=""),this.current.append(e)},g.content=function(e){return void 0===e&&(e=this.currToken),this.css.slice(e[T.FIELDS.START_POS],e[T.FIELDS.END_POS])},g.locateNextMeaningfulToken=function(e){void 0===e&&(e=this.position+1);for(var t=e;t<this.tokens.length;){if(!F[this.tokens[t][T.FIELDS.TYPE]])return t;t++}return-1},t=e,(r=[{key:"currToken",get:function(){return this.tokens[this.position]}},{key:"nextToken",get:function(){return this.tokens[this.position+1]}},{key:"prevToken",get:function(){return this.tokens[this.position-1]}}])&&j(t.prototype,r),n&&j(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=K,e.exports=t.default})),G=l((function(e,t){t.__esModule=!0,t.default=void 0;var r,n=(r=Q)&&r.__esModule?r:{default:r};var i=function(){function e(e,t){this.func=e||function(){},this.funcRes=null,this.options=t}var t=e.prototype;return t._shouldUpdateSelector=function(e,t){return void 0===t&&(t={}),!1!==u({},this.options,t).updateSelector&&"string"!=typeof e},t._isLossy=function(e){return void 0===e&&(e={}),!1===u({},this.options,e).lossless},t._root=function(e,t){return void 0===t&&(t={}),new n.default(e,this._parseOptions(t)).root},t._parseOptions=function(e){return{lossy:this._isLossy(e)}},t._run=function(e,t){var r=this;return void 0===t&&(t={}),new Promise((function(n,i){try{var o=r._root(e,t);Promise.resolve(r.func(o)).then((function(n){var i=void 0;return r._shouldUpdateSelector(e,t)&&(i=o.toString(),e.selector=i),{transform:n,root:o,string:i}})).then(n,i)}catch(e){return void i(e)}}))},t._runSync=function(e,t){void 0===t&&(t={});var r=this._root(e,t),n=this.func(r);if(n&&"function"==typeof n.then)throw new Error("Selector processor returned a promise to a synchronous call.");var i=void 0;return t.updateSelector&&"string"!=typeof e&&(i=r.toString(),e.selector=i),{transform:n,root:r,string:i}},t.ast=function(e,t){return this._run(e,t).then((function(e){return e.root}))},t.astSync=function(e,t){return this._runSync(e,t).root},t.transform=function(e,t){return this._run(e,t).then((function(e){return e.transform}))},t.transformSync=function(e,t){return this._runSync(e,t).transform},t.process=function(e,t){return this._run(e,t).then((function(e){return e.string||e.root.toString()}))},t.processSync=function(e,t){var r=this._runSync(e,t);return r.string||r.root.toString()},e}();t.default=i,e.exports=t.default})),V=l((function(e,t){t.__esModule=!0,t.universal=t.tag=t.string=t.selector=t.root=t.pseudo=t.nesting=t.id=t.comment=t.combinator=t.className=t.attribute=void 0;var r=d(C),n=d(I),i=d(R),o=d(L),s=d(x),a=d(U),u=d(A),c=d(_),f=d(w),l=d(M),p=d(D),h=d(q);function d(e){return e&&e.__esModule?e:{default:e}}t.attribute=function(e){return new r.default(e)};t.className=function(e){return new n.default(e)};t.combinator=function(e){return new i.default(e)};t.comment=function(e){return new o.default(e)};t.id=function(e){return new s.default(e)};t.nesting=function(e){return new a.default(e)};t.pseudo=function(e){return new u.default(e)};t.root=function(e){return new c.default(e)};t.selector=function(e){return new f.default(e)};t.string=function(e){return new l.default(e)};t.tag=function(e){return new p.default(e)};t.universal=function(e){return new h.default(e)}})),$=l((function(e,t){var r;t.__esModule=!0,t.isComment=t.isCombinator=t.isClassName=t.isAttribute=void 0,t.isContainer=function(e){return!(!i(e)||!e.walk)},t.isIdentifier=void 0,t.isNamespace=function(e){return s(e)||b(e)},t.isNesting=void 0,t.isNode=i,t.isPseudo=void 0,t.isPseudoClass=function(e){return p(e)&&!S(e)},t.isPseudoElement=S,t.isUniversal=t.isTag=t.isString=t.isSelector=t.isRoot=void 0;var n=((r={})[g.ATTRIBUTE]=!0,r[g.CLASS]=!0,r[g.COMBINATOR]=!0,r[g.COMMENT]=!0,r[g.ID]=!0,r[g.NESTING]=!0,r[g.PSEUDO]=!0,r[g.ROOT]=!0,r[g.SELECTOR]=!0,r[g.STRING]=!0,r[g.TAG]=!0,r[g.UNIVERSAL]=!0,r);function i(e){return"object"==typeof e&&n[e.type]}function o(e,t){return i(t)&&t.type===e}var s=o.bind(null,g.ATTRIBUTE);t.isAttribute=s;var a=o.bind(null,g.CLASS);t.isClassName=a;var u=o.bind(null,g.COMBINATOR);t.isCombinator=u;var c=o.bind(null,g.COMMENT);t.isComment=c;var f=o.bind(null,g.ID);t.isIdentifier=f;var l=o.bind(null,g.NESTING);t.isNesting=l;var p=o.bind(null,g.PSEUDO);t.isPseudo=p;var h=o.bind(null,g.ROOT);t.isRoot=h;var d=o.bind(null,g.SELECTOR);t.isSelector=d;var v=o.bind(null,g.STRING);t.isString=v;var b=o.bind(null,g.TAG);t.isTag=b;var y=o.bind(null,g.UNIVERSAL);function S(e){return p(e)&&e.value&&(e.value.startsWith("::")||":before"===e.value.toLowerCase()||":after"===e.value.toLowerCase()||":first-letter"===e.value.toLowerCase()||":first-line"===e.value.toLowerCase())}t.isUniversal=y})),H=l((function(e,t){t.__esModule=!0,Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===g[e]||(t[e]=g[e]))})),Object.keys(V).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===V[e]||(t[e]=V[e]))})),Object.keys($).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===$[e]||(t[e]=$[e]))}))})),z=l((function(e,t){t.__esModule=!0,t.default=void 0;var r,n=(r=G)&&r.__esModule?r:{default:r},i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=i?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(H);function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}var s=function(e){return new n.default(e)};u(s,i),delete s.__esModule;var a=s;t.default=a,e.exports=t.default})),J=f(z),K=Element.prototype.matches||Element.prototype.msMatchesSelector;var X=function(e){this._queue=[e],this.next()};function Z(e){for(var t=[],r=e.length-1;r>=0;r--){var n=e[r];if("combinator"===n.type)break;t.push(n)}return t.reverse()}function ee(e){if("function"!=typeof e.assignedElements&&e.assignedSlot&&e.assignedSlot.parentElement)return e.assignedSlot.parentElement;if(e.parentElement)return e.parentElement;var t=e.getRootNode();return t!==document?t.host:void 0}function te(e,t){for(var r=ee(e);r;){if(ne(r,{nodes:t}))return r;r=ee(r)}}function re(e,t){for(var r=e.previousElementSibling;r;){if(ne(r,{nodes:t}))return r;r=r.previousElementSibling}}function ne(e,t){for(var r=t.nodes,n=r.length-1;n>=0;n--){var i=r[n];if("id"===i.type){if(e.id!==i.value)return!1}else if("class"===i.type){if(!e.classList.contains(i.value))return!1}else if("tag"===i.type){if(e.tagName.toLowerCase()!==i.value.toLowerCase())return!1}else if("pseudo"===i.type||"attribute"===i.type){if(!K.call(e,i.sourceCode))return!1}else if("combinator"===i.type){if(" "===i.value){var o=Z(r.slice(0,n));return ie(e,o,r.slice(0,n-o.length))}if(">"===i.value){var s=Z(r.slice(0,n)),a=ee(e);if(!a||!ne(a,{nodes:s}))return!1;e=a,n-=1}else if("+"===i.value){var u=Z(r.slice(0,n)),c=e.previousElementSibling;if(!c||!ne(c,{nodes:u}))return!1;n-=u.length}else if("~"===i.value){var f=Z(r.slice(0,n));if(!re(e,f))return!1;n-=f.length}}}return!0}function ie(e,t,r){var n=te(e,t);if(!n)return!1;for(;n;){if(ne(n,{nodes:r}))return!0;n=te(n,t)}return!1}function oe(e,t){for(var r=0,n=e.nodes;r<n.length;r+=1){var i=n[r];if("pseudo"===i.type||"attribute"===i.type){for(var o=t.split("\n"),s=i.source,a=s.start,u=s.end,c="",f=a.line-1;f<u.line;f++){var l=o[f],p=f===a.line-1?a.column:0,h=f===u.line-1?u.column:l.length;c+=l.substring(p,h)}i.sourceCode=("pseudo"===i.type?":":"[")+c}i.nodes&&oe(i,t)}}function se(e){if(11!==e.nodeType&&9!==e.nodeType)throw new TypeError("Provided context must be of type Document or ShadowRoot")}function ae(e){var t=J().astSync(e);return oe(t,e),t}function ue(e,t,r){var n=ae(e);return function(e,t,r){for(var n,i=r?[]:null;n=e.next();)for(var o=0,s=t.nodes;o<s.length;o+=1)if(ne(n,s[o])){if(!r)return n;i.push(n)}return i}(new X(t),n,r)}return X.prototype.next=function(){var e=this._queue.pop();if(e){var t=function(e){return e.documentElement?[e.documentElement]:e.shadowRoot?e.shadowRoot.children:"function"==typeof e.assignedElements&&e.assignedNodes().length?e.assignedElements():e.children}(e);if(t)for(var r=t.length-1;r>=0;r--)this._queue.push(t[r])}return e},e.closest=function(e,t){for(var r=0,n=ae(e).nodes;r<n.length;r+=1){var i=n[r];if(ne(t,i))return t;var o=te(t,i.nodes);if(o)return o}return null},e.getElementById=function(e,t){return void 0===t&&(t=document),se(t),function(e,t){for(var r;r=e.next();)if(r.id===t)return r;return null}(new X(t),e)},e.getElementsByClassName=function(e,t){return void 0===t&&(t=document),function(e,t){for(var r,n=[],i=function(){var e=r.classList,i=t.every((function(t){return e.contains(t)}));i&&n.push(r)};r=e.next();)i();return n}(new X(t),e.trim().split(/\s+/))},e.getElementsByName=function(e,t){return void 0===t&&(t=document),se(t),function(e,t){for(var r,n=[];r=e.next();)r.name===t&&n.push(r);return n}(new X(t),e)},e.getElementsByTagName=function(e,t){return void 0===t&&(t=document),function(e,t){for(var r,n=[],i=t.toLowerCase();r=e.next();)"*"!==t&&i!==r.tagName.toLowerCase()||n.push(r);return n}(new X(t),e)},e.getElementsByTagNameNS=function(e,t,r){return void 0===r&&(r=document),function(e,t,r){var n,i=[];if(!t)return i;for(;n=e.next();){var o=n.outerHTML.toUpperCase().indexOf(n.tagName.toUpperCase()),s=r===n.outerHTML.substr(o,n.tagName.length)||"*"===r,a=n.namespaceURI===t||"*"===t;s&&a&&i.push(n)}return i}(new X(r),e,t)},e.matches=function(e,t){!function(e){if(!e||1!==e.nodeType)throw new TypeError("Provided context must be of type Element")}(t);for(var r=0,n=ae(e).nodes;r<n.length;r+=1){if(ne(t,n[r]))return!0}return!1},e.querySelector=function(e,t){return void 0===t&&(t=document),ue(e,t,!1)},e.querySelectorAll=function(e,t){return void 0===t&&(t=document),ue(e,t,!0)},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
